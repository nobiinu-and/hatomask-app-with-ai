# 機能仕様: 写真のアップロードとダウンロード（最小実装版）

## 概要

最初のステップとして、ユーザーが写真をアップロードし、その写真をそのままダウンロードできる最小限の機能を実装します。  
この機能は、後続の顔検出やハトマスク適用機能の基盤となります。

## スコープ

**この仕様は最小実装に限定**します。フロントエンドとバックエンドの基本的な連携を実装します。

## ユースケース

### 基本フロー

1. ユーザーがWebアプリケーションにアクセス
2. ファイル選択ボタンから写真を選択
3. 選択した写真をバックエンドにアップロード
4. バックエンドから返されたIDを使ってプレビュー表示
5. ダウンロードボタンをクリック
6. バックエンドから写真を取得してダウンロード

## 機能要件

### 1. 写真アップロード

#### アップロード方法
- **ファイル選択のみ**: ボタンクリックでファイル選択ダイアログを表示

#### 対応ファイル形式
- JPEG (.jpg, .jpeg)
- PNG (.png)

#### ファイルサイズ制限
- 最大ファイルサイズ: 10MB

### 2. プレビュー表示

- アップロードした写真を画面上にプレビュー表示
- 画像は表示領域に収まるようにリサイズ（アスペクト比は維持）

### 3. ダウンロード機能

- 「ダウンロード」ボタンをクリックで写真をダウンロード
- アップロードした写真をそのまま（無加工で）ダウンロード
- 写真がアップロードされていない場合はボタンを無効化

## UI/UX要件

### レイアウト

```
+------------------------------------------+
|           HatoMask App                   |
+------------------------------------------+
|                                          |
|      [ 写真を選択 ]                      |
|                                          |
|  +------------------------------------+  |
|  |                                    |  |
|  |        プレビューエリア            |  |
|  |     (写真がない場合は空白)         |  |
|  |                                    |  |
|  +------------------------------------+  |
|                                          |
|           [ ダウンロード ]               |
|                                          |
+------------------------------------------+
```

### デザイン要件

- シンプルなレイアウト
- 基本的なスタイリング（中央揃え、適切な余白）

## 受け入れ基準 - Specification by Example

### Scenario: JPEGファイルのアップロードとダウンロード

```gherkin
Given ユーザーがHatoMaskアプリケーションにアクセスしている
When ユーザーが「写真を選択」ボタンをクリックする
And ユーザーがファイルサイズ5MBのJPEGファイルを選択する
Then アップロードが成功する
And プレビューエリアに選択した画像が表示される
When ユーザーが「ダウンロード」ボタンをクリックする
Then 元の画像がダウンロードされる
```

### Scenario: PNGファイルのアップロードとダウンロード

```gherkin
Given ユーザーがHatoMaskアプリケーションにアクセスしている
When ユーザーが「写真を選択」ボタンをクリックする
And ユーザーがファイルサイズ3MBのPNGファイルを選択する
Then アップロードが成功する
And プレビューエリアに選択した画像が表示される
When ユーザーが「ダウンロード」ボタンをクリックする
Then 元の画像がダウンロードされる
```

### Scenario: 複数回の写真アップロード

```gherkin
Given ユーザーがHatoMaskアプリケーションにアクセスしている
When ユーザーが1枚目のJPEGファイルをアップロードする
Then 1枚目の画像がプレビューエリアに表示される
When ユーザーが「写真を選択」ボタンをクリックする
And ユーザーが2枚目のPNGファイルを選択する
Then アップロードが成功する
And プレビューエリアの画像が2枚目の画像に切り替わる
```

### Scenario: ファイルサイズ超過エラー

```gherkin
Given ユーザーがHatoMaskアプリケーションにアクセスしている
When ユーザーがファイルサイズ11MBのJPEGファイルを選択する
Then エラーメッセージ「ファイルサイズは10MB以下にしてください」が表示される
And 画像はアップロードされない
```

### Scenario: 非対応のファイル形式エラー

```gherkin
Given ユーザーがHatoMaskアプリケーションにアクセスしている
When ユーザーがGIF形式のファイルを選択する
Then エラーメッセージ「JPEG または PNG ファイルを選択してください」が表示される
And 画像はアップロードされない
```

## 将来の拡張候補

- ドラッグ&ドロップ対応
- ファイル情報の表示（ファイル名、サイズ、解像度）
- エラーメッセージの改善（UI上での表示）
- クラウドストレージへの保存（AWS S3など）
- 画像の編集機能（ハトマスク適用）
- ユーザー認証とアクセス制御
