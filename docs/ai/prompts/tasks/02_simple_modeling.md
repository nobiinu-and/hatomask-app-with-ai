---
description: 機能仕様書から簡単なドメインモデルを作成するためのプロンプトテンプレート
---

# 簡単にモデリング

## 依頼内容

以下の入力情報を基に、**機能仕様に明示的に記載されている機能**のドメインモデルを作成してください。

## 入力情報

- **マイルストーン(milestone_id)**: 例 `m0` / `m1`
- **アーキテクチャ設計**: `docs/spec/architecture/{milestone_id}.md`
- **機能仕様**: `[機能仕様のパス]`
- **テンプレート**: `docs/spec/templates/domain-model.template.md`

## 重要: 機能仕様に記載された機能のみ

**機能仕様に明示的に記載されている機能のみをモデル化してください。**

- 機能仕様に記載された機能を全て含める
- 機能仕様に記載されていない機能は含めない（推測しない）
- 各機能に必要なエンティティを洗い出す
- エンティティ間の関連を明示する

例: 「写真アップロード・ダウンロード機能」の機能仕様であれば：

- ✅ Photo（写真エンティティ）- 機能仕様に明記されている
- ✅ PhotoMetadata（メタデータ）- アップロード時に必要
- ❌ User（ユーザー）- 機能仕様に記載がなければ含めない
- ❌ Album（アルバム）- 機能仕様に整理機能の記載がなければ含めない
- ❌ Tag（タグ）- 機能仕様にタグ付け機能の記載がなければ含めない

## 出力形式

### 1. テンプレートの使用

`docs/spec/templates/domain-model.template.md` をベースにドメインモデルを作成してください。

### 2. 保存先

ドメインモデルのファイル名は **feature 名に固定しません**。次を満たすように `{model_name}` を決めてください。

- **優先**: リソース/ドメイン境界（例: `photo_upload.md`, `face_detection.md`）
- **避ける**: UI 操作や 1 シナリオに寄った feature 名のままの分断（例: `02_face_detection_static.yaml`）
- **既存優先**: 既に `docs/spec/models/*.md` に関連するモデルがある場合、まずは**追記・拡張**を検討

#### 3.1 ファイル作成

保存先: `docs/spec/models/{model_name}.md`
例: `docs/spec/models/photo_upload.md`

### 3. モデリング要素

テンプレートの各セクションに従い、以下の要素を記述してください。

#### エンティティ (Entity)

ライフサイクルを持ち、一意に識別される必要があるオブジェクト。

**記述ポイント**:

- 説明: エンティティの役割を明確に
- プロパティ: プロパティ名、型、制約条件
- バリデーションルール: ビジネスルールに基づく検証条件
- 関連: 他のエンティティとの関係

#### バリューオブジェクト (Value Object)

値そのものを表現し、同一性ではなく値の等価性で比較されるオブジェクト（不変）。

**記述ポイント**:

- 説明: 値の意味と責務
- プロパティ: 含まれる値
- バリデーションルール: 値の正当性チェック

#### リポジトリインターフェース (Repository Interface)

エンティティの永続化と取得を抽象化するインターフェース。

**記述ポイント**:

- 説明: 対象エンティティと責務
- メソッド: メソッドシグネチャと説明

#### ドメインサービス (Domain Service)

複数のエンティティにまたがるロジックや、エンティティに属さないドメインロジック（必要な場合のみ）。

**記述ポイント**:

- 説明: サービスの目的
- メソッド: 提供する操作

## 制約事項

1. **機能仕様に記載された機能のみ**: 機能仕様に明示的に記載されている機能のみをモデル化（推測・拡張しない）
2. **完全性**: 機能仕様に記載された全ての機能をモデルに含める（漏れなく）
3. **シンプルさ**: 過度に複雑なモデリングは避け、必要な最小限の要素に絞る
4. **ユビキタス言語**: ドメイン専門家とエンジニアが共通して使える用語を使用
5. **関連の明示**: エンティティ間の関連（1:1, 1:N, N:M）を明確にする

## 実装手順

1. **テンプレート取得**: `docs/spec/templates/domain-model.template.md` を参照
2. **機能仕様 分析**: 機能仕様書を読み、必要なエンティティを洗い出す
3. **model_name 決定（必須）**: `docs/spec/models/*.md` を棚卸しし、既存のモデルに追記できないかを確認したうえで `{model_name}` を決める
4. **モデル作成**: テンプレートに従い `docs/spec/models/{model_name}.md` を作成（迷う場合のみ `{feature_name}.md`）
5. **チェックリスト確認**: 制約事項と完全性を検証

## チェックリスト

モデリング完了前に確認:

- [ ] 機能仕様に**記載された機能のみ**がモデルに反映されている（追加・推測していない）
- [ ] 機能仕様に記載された**全ての機能**がモデルに含まれている（漏れがない）
- [ ] 各機能に必要な**エンティティ**を洗い出した
- [ ] エンティティ間の**関連**を明示した
- [ ] 各エンティティに必要な**リポジトリインターフェース**を定義した

## 次のステップ

このモデリング成果物は、次のタスクで使用されます:

- **Task03: API Contract 設計 + ドメインモデル見直し** - API 仕様と整合性を確認し、必要に応じてこのモデルを更新
- **Task04: Gherkin シナリオ作成 + 実装計画策定** - このモデルを参照して実装計画を立案
- **Task06: 縦切り実装サイクル (バックエンド)** - ドメイン層の実装時に参照

**重要**: Task03 で API との整合性を確認し、必要に応じて見直すことで、Task06 の実装時に一貫性が保たれます。
